{{ 'product-reviews.css' | asset_url | stylesheet_tag }}

<div class="product-reviews">
  <h2 class="product-reviews__heading">{{ 'products.product.banner.reviews' | t }}</h2>

  {% if product.metafields.custom.review_json %}
    {% assign reviews = product.metafields.custom.review_json.value %}
    {% assign has_reviews = true %}
  {% else %}
    {% assign has_reviews = false %}
  {% endif %}

  <div class="product-reviews__cards">
    {% if has_reviews %}
      {% for review in reviews limit: 3 %}
        <div class="review-card">
          <div class="review-card__stars">
            {% for i in (1..5) %}
              {% if i <= review.stars %}
                <img src="{{ 'rating-star.svg' | asset_url }}" alt="Star" class="review-card__star">
              {% else %}
                <img src="{{ 'rating-star-empty.svg' | asset_url }}" alt="Empty star" class="review-card__star">
              {% endif %}
            {% endfor %}
          </div>

          {% if review.review %}
            <p class="review-card__review">{{ review.review }}</p>
          {% endif %}

          <div class="review-card__author">
            {% if review.photo %}
              <img
                src="{{ review.photo }}"
                alt="{{ review.name | escape }}"
                class="review-card__photo"
                loading="lazy"
                width="60"
                height="60"
              >
            {% endif %}

            <div class="review-card__info">
              {% if review.name %}
                <div class="review-card__name">{{ review.name }}</div>
              {% endif %}
              {% if review.town %}
                <div class="review-card__town">{{ review.town }}</div>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    {% else %}
      {% comment %} Fallback reviews {% endcomment %}
      <div class="review-card">
        <div class="review-card__stars">
          <img src="{{ 'rating-star.svg' | asset_url }}" alt="Star" class="review-card__star">
          <img src="{{ 'rating-star.svg' | asset_url }}" alt="Star" class="review-card__star">
          <img src="{{ 'rating-star.svg' | asset_url }}" alt="Star" class="review-card__star">
          <img src="{{ 'rating-star.svg' | asset_url }}" alt="Star" class="review-card__star">
          <img src="{{ 'rating-star.svg' | asset_url }}" alt="Star" class="review-card__star">
        </div>
        <p class="review-card__review">Absolutely love this product! The quality is outstanding and it exceeded my expectations. Highly recommend to anyone looking for premium quality.</p>
        <div class="review-card__author">
          <img
            src="https://randomuser.me/api/portraits/women/44.jpg"
            alt="Sarah Johnson"
            class="review-card__photo"
            loading="lazy"
            width="60"
            height="60"
          >
          <div class="review-card__info">
            <div class="review-card__name">Sarah Johnson</div>
            <div class="review-card__town">Los Angeles</div>
          </div>
        </div>
      </div>

      <div class="review-card">
        <div class="review-card__stars">
          <img src="{{ 'rating-star.svg' | asset_url }}" alt="Star" class="review-card__star">
          <img src="{{ 'rating-star.svg' | asset_url }}" alt="Star" class="review-card__star">
          <img src="{{ 'rating-star.svg' | asset_url }}" alt="Star" class="review-card__star">
          <img src="{{ 'rating-star.svg' | asset_url }}" alt="Star" class="review-card__star">
          <img src="{{ 'rating-star.svg' | asset_url }}" alt="Star" class="review-card__star">
        </div>
        <p class="review-card__review">Great purchase! Fast shipping and the product looks even better in person. The attention to detail is impressive.</p>
        <div class="review-card__author">
          <img
            src="https://randomuser.me/api/portraits/men/32.jpg"
            alt="Michael Chen"
            class="review-card__photo"
            loading="lazy"
            width="60"
            height="60"
          >
          <div class="review-card__info">
            <div class="review-card__name">Michael Chen</div>
            <div class="review-card__town">San Francisco</div>
          </div>
        </div>
      </div>

      <div class="review-card">
        <div class="review-card__stars">
          <img src="{{ 'rating-star.svg' | asset_url }}" alt="Star" class="review-card__star">
          <img src="{{ 'rating-star.svg' | asset_url }}" alt="Star" class="review-card__star">
          <img src="{{ 'rating-star.svg' | asset_url }}" alt="Star" class="review-card__star">
          <img src="{{ 'rating-star.svg' | asset_url }}" alt="Star" class="review-card__star">
          <img src="{{ 'rating-star-empty.svg' | asset_url }}" alt="Empty star" class="review-card__star">
        </div>
        <p class="review-card__review">Very satisfied with my order. The product is well-made and stylish. Would definitely buy again!</p>
        <div class="review-card__author">
          <img
            src="https://randomuser.me/api/portraits/women/68.jpg"
            alt="Emma Williams"
            class="review-card__photo"
            loading="lazy"
            width="60"
            height="60"
          >
          <div class="review-card__info">
            <div class="review-card__name">Emma Williams</div>
            <div class="review-card__town">Seattle</div>
          </div>
        </div>
      </div>
    {% endif %}
  </div>
</div>

{% schema %}
{
  "name": "Product Reviews",
  "tag": "section",
  "class": "product-reviews-section",
  "settings": [],
  "presets": [
    {
      "name": "Product Reviews"
    }
  ]
}
{% endschema %}
